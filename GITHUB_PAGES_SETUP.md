# GitHub Pages Deployment Setup

> **Important**: This project is primarily configured for Netlify deployment. If you're deploying to production, we recommend using Netlify (see [NETLIFY_DEPLOYMENT_GUIDE.md](./NETLIFY_DEPLOYMENT_GUIDE.md)).

This guide explains how to set up GitHub Pages deployment if needed for testing or alternative hosting.

## Why This Guide Exists

This repository contains a React Single Page Application (SPA) built with Vite. The `index.html` file at the root is **not** a static HTML page - it's an entry point that loads the React application via `/src/main.tsx`.

**Do not replace `index.html` with static HTML content.** This will break the application.

## Understanding the Repository Structure

```
├── index.html              # React/Vite entry point (not a static page!)
├── src/                    # React application source code
│   ├── main.tsx           # Application entry point
│   ├── App.tsx            # Main app component
│   └── ...
├── dist/                   # Build output (generated, not committed)
├── netlify.toml            # Netlify configuration
└── CNAME                   # Custom domain configuration
```

## The CNAME File

The `CNAME` file in this repository contains the custom domain `leeukopf.com`. This file:
- Is used by the custom domain DNS configuration
- Does **not** automatically enable GitHub Pages
- Does **not** mean the site is deployed to GitHub Pages by default

## How to Deploy to GitHub Pages (If Needed)

If you want to use GitHub Pages alongside or instead of Netlify, you need to set up a build-and-deploy workflow:

### Option 1: Automated GitHub Actions Workflow (Recommended)

Create `.github/workflows/deploy-gh-pages.yml`:

```yaml
name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - uses: actions/setup-node@v4
        with:
          node-version: 20
          
      - name: Install dependencies
        run: npm ci
        
      - name: Build
        run: npm run build
        env:
          VITE_SUPABASE_URL: ${{ secrets.VITE_SUPABASE_URL }}
          VITE_SUPABASE_ANON_KEY: ${{ secrets.VITE_SUPABASE_ANON_KEY }}
        
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./dist

  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
```

Then configure GitHub Pages:
1. Go to repository **Settings** → **Pages**
2. Under **Source**, select **GitHub Actions**
3. Add repository secrets for environment variables (Settings → Secrets → Actions):
   - `VITE_SUPABASE_URL`
   - `VITE_SUPABASE_ANON_KEY`

### Option 2: Manual Deploy to gh-pages Branch

```bash
# Build the project
npm run build

# Deploy dist folder to gh-pages branch
npx gh-pages -d dist -t true

# The -t flag ensures dotfiles (like .nojekyll) are included
```

Then configure GitHub Pages:
1. Go to repository **Settings** → **Pages**
2. Under **Source**, select **Deploy from a branch**
3. Select branch: **gh-pages**, folder: **/ (root)**

### Important Notes

1. **Never commit the `dist` folder** to the main branch - it's generated by the build process
2. **Never replace `index.html`** with static HTML - it breaks the React app
3. **Environment variables** must be set in GitHub Secrets for the workflow to work
4. **Base path**: If deploying to `username.github.io/repo-name`, update `vite.config.ts`:
   ```typescript
   export default defineConfig({
     base: '/repo-name/',
     // ... rest of config
   });
   ```
   For custom domains or root deployments, keep `base: '/'`

## Common Mistakes to Avoid

### ❌ Don't Do This
```html
<!-- DON'T replace index.html with static content -->
<!DOCTYPE html>
<html>
  <body>
    <h1>Welcome to my site</h1>
    <p>Static content here...</p>
  </body>
</html>
```

### ✅ Do This
```html
<!-- Keep the React/Vite entry point structure -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Leeukopf Laboratories - Premium Gel Polish Manufacturing</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
```

## Testing Your Setup

After deploying:

1. Visit your GitHub Pages URL
2. Check that all routes work (not just the homepage)
3. Verify that client-side routing doesn't cause 404 errors
4. Test that the React application loads correctly

If you encounter 404 errors on routes:
- GitHub Pages doesn't natively support SPA routing
- You may need to add a custom 404.html that redirects to index.html
- Or consider using a service like Netlify that has built-in SPA support

## Deployment Comparison

| Feature | Netlify | GitHub Pages |
|---------|---------|--------------|
| SPA Support | ✅ Built-in | ⚠️ Requires workarounds |
| Custom Domain | ✅ Easy setup | ✅ Supported via CNAME |
| Build Process | ✅ Automatic | ⚠️ Needs workflow setup |
| Environment Variables | ✅ Dashboard UI | ⚠️ GitHub Secrets |
| Redirects | ✅ Full support | ❌ Limited |
| Serverless Functions | ✅ Supported | ❌ Not supported |
| Preview Deploys | ✅ Automatic | ❌ Manual only |

## Recommended Approach

**For Production**: Use Netlify
- Already configured in `netlify.toml`
- Better SPA support
- Easier environment variable management
- Includes serverless functions for API endpoints

**For GitHub Pages**: Use only if you have specific requirements
- Requires additional workflow setup
- May need SPA routing workarounds
- Limited to static hosting only

## Need Help?

- **Netlify Issues**: See [NETLIFY_DEPLOYMENT_GUIDE.md](./NETLIFY_DEPLOYMENT_GUIDE.md)
- **Build Errors**: Check the CI workflow logs
- **React Issues**: Verify `index.html` hasn't been modified
- **Routing Issues**: Ensure SPA redirects are configured

## References

- [GitHub Pages Documentation](https://docs.github.com/en/pages)
- [Vite Deployment Guide](https://vitejs.dev/guide/static-deploy.html)
- [gh-pages npm package](https://www.npmjs.com/package/gh-pages)
